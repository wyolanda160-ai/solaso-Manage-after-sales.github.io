<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COD退款详情 - 平台总后台</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1890ff',
                        success: '#52c41a',
                        warning: '#faad14',
                        error: '#ff4d4f',
                        info: '#8c8c8c',
                        'primary-light': '#e6f7ff',
                        'success-light': '#f6ffed',
                        'warning-light': '#fff7e6',
                        'error-light': '#fff1f0',
                        'border-color': '#e8e8e8',
                        'text-secondary': '#666666'
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .active-nav-item {
                @apply bg-primary-light text-primary border-l-4 border-primary;
            }
            .card {
                @apply bg-white rounded-lg shadow-sm p-6;
            }
            .badge {
                @apply inline-flex items-center px-2 py-1 text-xs font-medium rounded-full;
            }
            .btn {
                @apply px-4 py-2 text-sm font-medium rounded-md transition-all duration-200;
            }
            .btn-primary {
                @apply bg-primary text-white hover:bg-primary/90;
            }
            .btn-success {
                @apply bg-success text-white hover:bg-success/90;
            }
            .btn-error {
                @apply bg-error text-white hover:bg-error/90;
            }
            .btn-outline {
                @apply border border-border-color text-text-secondary hover:bg-gray-50;
            }
            .upload-area {
                @apply border-2 border-dashed border-border-color rounded-lg p-8 text-center hover:border-primary transition-all cursor-pointer;
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="flex h-screen overflow-hidden">
        <!-- 侧边导航 -->
        <aside class="w-64 bg-white shadow-md flex flex-col">
            <div class="h-16 flex items-center justify-center border-b border-border-color">
                <h1 class="text-xl font-bold text-primary">平台总后台</h1>
            </div>
            
            <nav class="flex-1 py-4">
                <div class="px-4 mb-2 text-xs font-medium text-text-secondary uppercase">
                    售后管理
                </div>
                <a href="admin-after-sales-list.html" class="flex items-center px-4 py-3 text-text-secondary hover:bg-gray-50">
                    <i class="fa fa-list-alt w-5 mr-3"></i>
                    <span>售后单管理</span>
                </a>
                <a href="index.html" class="flex items-center px-4 py-3 text-text-secondary hover:bg-gray-50">
                    <i class="fa fa-gavel w-5 mr-3"></i>
                    <span>平台介入管理</span>
                </a>
                <a href="admin-cod-refund.html" class="flex items-center px-4 py-3 active-nav-item">
                    <i class="fa fa-money w-5 mr-3"></i>
                    <span>COD退款管理</span>
                </a>
                
                <div class="px-4 mt-6 mb-2 text-xs font-medium text-text-secondary uppercase">
                    配置管理
                </div>
                <a href="admin-after-sales-config.html" class="flex items-center px-4 py-3 text-text-secondary hover:bg-gray-50">
                    <i class="fa fa-cog w-5 mr-3"></i>
                    <span>售后配置管理</span>
                </a>
                <a href="admin-after-sales-analysis.html" class="flex items-center px-4 py-3 text-text-secondary hover:bg-gray-50">
                    <i class="fa fa-bar-chart w-5 mr-3"></i>
                    <span>售后统计分析</span>
                </a>
            </nav>
            
            <div class="p-4 border-t border-border-color">
                <div class="flex items-center">
                    <img class="w-10 h-10 rounded-full" src="https://picsum.photos/id/1005/200/200" alt="管理员">
                    <div class="ml-3">
                        <p class="text-sm font-medium">张管理员</p>
                        <p class="text-xs text-text-secondary">超级管理员</p>
                    </div>
                </div>
            </div>
        </aside>
        
        <!-- 主内容区 -->
        <main class="flex-1 flex flex-col overflow-hidden">
            <header class="h-16 bg-white shadow-sm flex items-center justify-between px-6">
                <div class="flex items-center">
                    <div class="flex items-center text-sm">
                        <a href="index.html" class="text-text-secondary hover:text-primary">首页</a>
                        <i class="fa fa-angle-right text-xs text-text-secondary mx-2"></i>
                        <a href="admin-cod-refund.html" class="text-text-secondary hover:text-primary">COD退款管理</a>
                        <i class="fa fa-angle-right text-xs text-text-secondary mx-2"></i>
                        <span class="font-medium">退款详情</span>
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <button class="text-text-secondary hover:text-primary">
                        <i class="fa fa-bell text-xl"></i>
                    </button>
                </div>
            </header>
            
            <div class="flex-1 overflow-y-auto p-6">
                <!-- 退款单基本信息 -->
                <div class="card mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center">
                            <h3 class="text-lg font-medium mr-3">退款单号：CR202306150001</h3>
                            <span class="badge bg-warning-light text-warning">待审核</span>
                            <span class="badge bg-primary-light text-primary ml-2">COD退款</span>
                        </div>
                        <div class="flex items-center space-x-3" id="cod-actions">
                            <button class="btn btn-primary" onclick="showUploadModal()">
                                <i class="fa fa-upload mr-1"></i> 上传转账凭证
                            </button>
                        </div>
                        <div class="hidden items-center space-x-3" id="online-actions">
                            <span class="text-sm text-text-secondary">在线退款由系统自动处理</span>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-6">
                        <div>
                            <h4 class="text-sm font-medium text-text-secondary mb-3">基本信息</h4>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span class="text-sm text-text-secondary">订单编号</span>
                                    <span class="text-sm font-medium">SO202306140001</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-text-secondary">退款金额</span>
                                    <span class="text-sm font-medium text-error">¥299.00</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-text-secondary">支付方式</span>
                                    <span class="badge bg-warning-light text-warning">COD货到付款</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-text-secondary">退款方式</span>
                                    <span class="badge bg-primary-light text-primary">COD退款</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-text-secondary">申请时间</span>
                                    <span class="text-sm">2023-06-15 10:23:45</span>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="text-sm font-medium text-text-secondary mb-3">用户信息</h4>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span class="text-sm text-text-secondary">用户昵称</span>
                                    <span class="text-sm font-medium">小明同学</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-text-secondary">用户ID</span>
                                    <span class="text-sm">U1000123</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-text-secondary">手机号</span>
                                    <span class="text-sm">138****6789</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-text-secondary">收款账号</span>
                                    <span class="text-sm">6222 **** **** 1234</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-text-secondary">开户行</span>
                                    <span class="text-sm">工商银行北京分行</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 转账凭证 -->
                <div class="card mb-6" id="transfer-proof-section">
                    <h3 class="font-medium mb-4">转账凭证（非必填）</h3>
                    <div id="proof-upload-area" class="upload-area" onclick="document.getElementById('file-input').click()">
                        <i class="fa fa-cloud-upload text-4xl text-text-secondary mb-2"></i>
                        <p class="text-text-secondary">点击上传转账凭证或拖拽文件到此处</p>
                        <p class="text-xs text-text-secondary mt-1">支持 JPG、PNG、PDF 格式，文件大小不超过 5MB</p>
                        <input type="file" id="file-input" class="hidden" accept="image/*,application/pdf" onchange="handleFileUpload(event)">
                    </div>
                    
                    <div id="proof-preview" class="hidden mt-4">
                        <div class="flex items-center justify-between p-4 border border-border-color rounded-lg">
                            <div class="flex items-center">
                                <i class="fa fa-file-image-o text-2xl text-primary mr-3"></i>
                                <div>
                                    <p class="text-sm font-medium" id="file-name">转账凭证.jpg</p>
                                    <p class="text-xs text-text-secondary" id="file-size">1.2 MB</p>
                                </div>
                            </div>
                            <button class="text-error hover:text-error/80" onclick="removeFile()">
                                <i class="fa fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- 退款原因 -->
                <div class="card mb-6">
                    <h3 class="font-medium mb-4">退款原因</h3>
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <p class="text-sm">商品质量问题，收到货物后发现有明显瑕疵，与商品描述不符。</p>
                    </div>
                </div>
                
                <!-- 处理记录 -->
                <div class="card">
                    <h3 class="font-medium mb-4">处理记录</h3>
                    <div class="space-y-4">
                        <div class="flex">
                            <div class="w-32 text-sm text-text-secondary">2023-06-15 10:23</div>
                            <div class="flex-1">
                                <p class="text-sm">用户发起退款申请</p>
                                <p class="text-xs text-text-secondary mt-1">用户：小明同学 | 退款金额：¥299.00</p>
                            </div>
                        </div>
                        <div class="flex">
                            <div class="w-32 text-sm text-text-secondary">2023-06-15 10:25</div>
                            <div class="flex-1">
                                <p class="text-sm">系统自动审核通过</p>
                                <p class="text-xs text-text-secondary mt-1">符合自动审核条件</p>
                            </div>
                        </div>
                        <div class="flex">
                            <div class="w-32 text-sm text-text-secondary">待处理</div>
                            <div class="flex-1">
                                <p class="text-sm text-warning">等待管理员上传转账凭证</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- 上传凭证模态框 -->
    <div id="upload-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 w-96">
            <h3 class="text-lg font-medium mb-4">上传转账凭证</h3>
            <div class="upload-area mb-4" onclick="document.getElementById('modal-file-input').click()">
                <i class="fa fa-cloud-upload text-4xl text-text-secondary mb-2"></i>
                <p class="text-text-secondary">点击选择文件</p>
                <input type="file" id="modal-file-input" class="hidden" accept="image/*,application/pdf">
            </div>
            <div class="flex justify-end space-x-3">
                <button class="btn btn-outline" onclick="hideUploadModal()">取消</button>
                <button class="btn btn-primary" onclick="confirmUpload()">确认上传</button>
            </div>
        </div>
    </div>
    
    <script>
        // 判断退款类型并显示对应操作按钮
        const urlParams = new URLSearchParams(window.location.search);
        const refundId = urlParams.get('id');
        
        // 根据退款类型显示不同操作（这里简化处理，实际应从后端获取）
        const isOnlineRefund = refundId && refundId.includes('0002'); // 示例判断
        
        if (isOnlineRefund) {
            document.getElementById('cod-actions').classList.add('hidden');
            document.getElementById('online-actions').classList.remove('hidden');
            document.getElementById('transfer-proof-section').classList.add('hidden');
        }
        
        function showUploadModal() {
            document.getElementById('upload-modal').classList.remove('hidden');
        }
        
        function hideUploadModal() {
            document.getElementById('upload-modal').classList.add('hidden');
        }
        
        function confirmUpload() {
            alert('转账凭证已上传');
            hideUploadModal();
        }
        
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (file) {
                document.getElementById('proof-upload-area').classList.add('hidden');
                document.getElementById('proof-preview').classList.remove('hidden');
                document.getElementById('file-name').textContent = file.name;
                document.getElementById('file-size').textContent = (file.size / 1024 / 1024).toFixed(2) + ' MB';
            }
        }
        
        function removeFile() {
            document.getElementById('proof-upload-area').classList.remove('hidden');
            document.getElementById('proof-preview').classList.add('hidden');
            document.getElementById('file-input').value = '';
        }
        
        function approveRefund() {
            if (confirm('确认通过此退款申请？')) {
                alert('退款审核已通过！');
                window.location.href = 'admin-cod-refund.html';
            }
        }
        
        function rejectRefund() {
            const reason = prompt('请输入拒绝原因：');
            if (reason) {
                alert('已拒绝退款申请');
                window.location.href = 'admin-cod-refund.html';
            }
        }
    </script>
</body>
</html>
